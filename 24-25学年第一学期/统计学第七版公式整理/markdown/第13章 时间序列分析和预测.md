## 第十三章 时间序列分析和预测

[toc]

### 13.1 时间序列及其分解

时间序列包括趋势（$T$）、季节性（$S$）、周期性（$C$）和随机性（$I$）。本章介绍的时间序列分析基于乘法模型，即
$$
Y_t=T_t\times S_t\times C_t\times I_t
$$

### 13.2 时间序列的描述型分析

#### 13.2.2 增长率分析

增长率是时间序列中报告期与基期观察值之比减去 $1$ 的结果。

*   环比增长率：$G_i=(Y_i-Y_{i-1})/Y_{i-1}$；
*   定基增长率：$G_i=(Y_i-Y_{0})/Y_0$

平均增长率是逐期环比的几何平均数减去 $1$ 的结果。
$$
\bar{G_i}=\sqrt[n]{\left(\frac{Y_1}{Y_0}\right)\left(\frac{Y_2}{Y_1}\right)\dots\left(\frac{Y_n}{Y_{n-1}}\right)}-1=\sqrt[n]{\left(\frac{Y_n}{Y_0}\right)}-1
$$
**需要注意的问题**

1.   时间序列出现 0 或者负数时不宜计算增长率；
2.   要将增长率与绝对水平结合分析。

### 13.3 时间序列预测的程序

根据趋势和季节成分选择预测方法。

*   无趋势且无季节性——平滑预测法：简单平均法、移动平均法、指数平滑法；
*   有趋势但无季节性——趋势预测法：线性趋势推测、非线性趋势推测、自回归预测模型；
*   有季节性——季节性预测法：季节多元回归模型、季节自回归模型、时间序列分解。

#### 13.3.3 预测方法的评估

设时间序列的第 $i$ 个观测值为 $Y_i$，预测值为 $F_i$，预测值的个数

*   平均误差 ME, 平均绝对误差 MAD， 
    $$
    ME=\frac{\sum_{i=1}^n(Y_i-F_i)}{n},\quad MAD=\frac{\sum_{i=1}^n|Y_i-F_i|}{n}
    $$

*   

*   均方误差 MSE
    $$
    MSE=\frac{\sum_{i=1}^n(Y_i-F_i)^2}{n}
    $$

*   

*   平均百分比误差 MPE 和平均绝对百分比误差 MAPE
    $$
    MPE=\frac{\sum_{i=1}^n(\frac{Y_i-F_i}{Y_i}\times100)}{n}, \quad MAPE=\frac{\sum_{i=1}^n|\frac{Y_i-F_i}{Y_i}|\times100}{n}
    $$

### 13.4 平稳序列的预测

#### 13.4.1 简单平均法

根据已有的 $t$ 期观察值求简单平均得到 $t+1$ 期的预测值，$t+2$ 期就递推
$$
F_{t+1}=\frac{1}{t}\sum_{i=1}^tY_i,\quad e_{t+1}=Y_{t+1}-F_{t+1}
$$

#### 13.4.2 移动平均法

将最近的 $k$ 期求平均作为下一期的预测值，以此类推。
$$
F_{t+1}=\bar{Y}_t=\frac{1}{k}\sum_{i=t-k+1}^t Y_i
$$

#### 13.4.3 指数平滑法

一次指数平滑法只有一个平滑系数，观察值离预测时期越远就权重越小。
$$
F_{t+1}=\alpha Y_t+(1-\alpha)F_t=F_t+\alpha(Y_t-F_t)
$$
通常是从 $F_1=T_1$ 开始往下递推。平滑指数 $\alpha$ 越接近1，模型对时间序列变化越及时。

### 13.5 趋势型序列的预测

#### 13.5.1 线性趋势

当现象按照线性区是发展的时候，
$$
\hat{Y}_t=b_0+b_1t
$$
按回归中的最小二乘法求得$b_0,b_1$；
$$
\begin{cases}
b_1 &=\frac{n\sum tY-\sum t\sum Y}{n\sum t^2-(\sum t)^2} \\
b_0 &=\bar{Y} - b_1t
\end{cases}
$$
预测趋势的误差用估计标准误差（$m$ 是趋势方程中的未知数个数，直线 $m=2$）
$$
s_e=\sqrt{\frac{\sum_{i=1}^n(Y_i-\hat{Y}_i)^2}{n-m}}
$$

#### 13.5.2 非线性趋势预测

**指数曲线** $\hat{Y}_t=b_0b_1^t$ 转化为直线形式，求得 $\lg b_0$ 和 $\lg b_1$
$$
\begin{cases}
\sum \lg Y &=n\lg b_0 + \lg b_1\sum t \\
\sum t\lg Y &=\lg b_0\sum t + \lg b_1 \sum t^2
\end{cases}
$$
**多阶曲线** $\hat{Y}_t=b_0+b_1t+\dots+b_kt^k$

### 13.6 复合型序列的分解预测

第一步：确定并分离季节成分。

1.   计算移动平均（季度4项，月份12项），并中心化处理；

2.   计算移动平均的比值，然后计算各个季度的平均值；

3.   季节指数调整。

4.   $$
     \frac{Y}{S}=\frac{T\times S\times I}{S} = T\times I
     $$

5.   

第二步：建立预测模型并进行预测。

第三步：计算预测值。

