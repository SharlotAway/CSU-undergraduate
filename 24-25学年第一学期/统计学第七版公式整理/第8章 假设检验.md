## 第八章 假设检验

[TOC]

### 8.1 假设检验的基本问题

$H_0$ 原假设（$=,\leq,\geq $）， $H_1$ 备择假设（$\neq,>,<$）互斥。

**$\alpha$ 错误：** 原假设为真，但被拒绝了，页脚弃真错误；

**$\beta$ 错误：** 原假设为假，却被接受了，也叫取伪错误。

#### 8.1.4 假设检验的流程

1.   提出原假设和备择假设
2.   计算 $z$ 统计量，将统计量转化为标准得分，
3.   根据显著性水平（$\alpha$）查表得到临界值，并与 $z$ 进行比较。（单侧检验还是双侧检验）
4.   根据 $z$ 是否在临界值之间决定是否接受原假设。



### 8.2 一个总体参数的检验

#### 8.2.1 检验统计量的确定

**样本量大或者总体正态**，用 $z$ 统计量，如果 $\sigma$ 未知，则用 $s$ 替代。
$$
z=\frac{\overline{x}-\mu_0}{\sigma/\sqrt{n}}
$$
**小样本且标准未知**，用 $t$ 统计量，自由度为 $n-1$
$$
t=\frac{\overline{x}-\mu_0}{s/\sqrt{n}}
$$

#### 8.2.2 总体均值的检验

大样本 $z$ 统计量，小样本 $t$ 统计量。

#### 8.2.3 总体比例的检验

如果总体比例的真实值为$\pi$，假设总体比例为 $\pi_0$，样本比例为 $p$，使用 $z$ 统计量进行假设检验
$$
z=\frac{p-\pi_0}{\sqrt{\frac{\pi_0(1-\pi_0)}{n}}}
$$

#### 8.2.4 总体方差的检验

如果总体方差的真实值为 $\sigma^2$，假设值为 $\sigma_0^2$，样本方差为 $s^2$，使用 $\chi^2$ 统计量进行假设检验，

$\chi^2$ 检验通常是单侧检验，临界点在 $\chi^2$ 分布右侧斜尾方向。
$$
\chi^2=\frac{(n-1)s^2}{\sigma^2}
$$


### 8.3 两个总体参数的检验

#### 8.3.1 检验统计量的确定

小样本，方差未知用 $t$ 统计；方差比检验用$F$ 统计；其余都是 $z$ 统计量。

#### 8.3.2 两个总体均值之差的检验

如果 $\sigma_1^2$ 和 $\sigma_2^2$ 已知，
$$
z=\frac{(x_1-x_2)-(\mu_1-\mu_2)}{\sqrt{\frac{\sigma_1^2}{n_1}+\frac{\sigma_2^2}{n}}}
$$

如果  $\sigma_1^2$ 和 $\sigma_2^2$ 未知，且样本量较小，使用 $t$ 统计，根据方差是否相等选择不同的自由度。
$$
t = \frac{(\overline{x}_1-\overline{x}_2)-(\mu_1-\mu_2)}{\hat{\sigma}_{x_1-x_2}}
$$
**Case 1: ** $\sigma_1^2=\sigma_2^2$，使用自由度为 $n_1+n_2-2$ 的 $t$ 统计量检验，其中
$$
\hat{\sigma}_{x_1-x_2}=s_p\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}，s_p=\frac{(n_1-1)s_1^2+(n_2-1)s_2^2}{n_1+n_2-2}
$$

**Case 2: ** $\sigma_1^2\neq\sigma_2^2$，使用自由度为 $f$ 的 $t$ 分布（近似），其中
$$
\hat{\sigma}_{x_1-x_2}=\sqrt{\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2}}
$$

$$
\begin{aligned}
f &= \frac{\left(\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2}\right)^2}
{\frac{\left(s_1^2/n_1\right)^2}{n_1-1} + \frac{\left(s_2^2/n_2\right)^2}{n_2-1}}
\end{aligned}
$$

#### 8.3.3 两个总体比例之差

**1. 两个总体比例相等的假设**

在原假设成立的情况下最佳的方差是 $p(1-p)$，其中 $p=(x_1+x_2)/(n_1+n_2)$，在大样本条件下，统计量 $z$ 的表达式为（$p_1,p_2$ 是样本比例）
$$
z=\frac{p_1-p_2}{\sqrt{p(1-p)(\frac{1}{n_1}+\frac{1}{n_2})}}
$$
**2. 检验两个总体比例之差不为0的假设**

原假设 $H_0: \pi_1-\pi_2=d_0$，$p_1-p_2\sim\mathcal{N}(\pi_1-\pi_2,\frac{p_1(1-p_1)}{n_1}+\frac{p_2(1-p_2)}{n_2})$
$$
z=\frac{p_1-p_2-d_0}{\sqrt{\frac{p_1(1-p_1)}{n_1}+\frac{p_2(1-p_2)}{n_2}}}
$$

#### 8.3.4 两个总体方差比的检验

方差之比服从 $F$ 分布
$$
F(n_1-1,n_2-1)=\frac{s_1^2}{s_2^2}\frac{\sigma_2^2}{\sigma_1^2}
$$
原假设 $H_0:\sigma_1^2\leq\sigma_2^2$， 备择假设 $H_1:\sigma_1^2>\sigma_2^2$，临界点为 $F_\alpha(n_1-1,n_2-1)$

双侧检验的两个临界点为$F_{\alpha/2}(n_1-1,n_2-1), F_{1-\alpha/2}(n_1-1,n_2-1)$
$$
F_{1-\alpha/2}(n_1-1,n_2-1)=\frac{1}{F_{\alpha/2}(n_2-1,n_1-1)}
$$

#### 8.3.5 检验中的匹配样本

如果是匹配样本，如果计算差值

1.   提出原假设，备择假设

2.   分别求出每个对应的差 $x=x_1-x_2$
3.   计算差值样本均值$\overline{x}$ 和标准差 $s$
4.   得到抽样分布的标准差估计值 $\hat{\sigma}_x={s}/{\sqrt{n}}$
5.   根据样本量大小选择 $z$ 或者 $t$，
6.   以 $t$ 为例，比较差值的均值和临界值 $d\pm t_\alpha$



### 8.4 检验问题的进一步说明

